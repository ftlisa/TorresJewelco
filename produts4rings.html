<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details - Torres Jewel Co</title>
  <link rel="stylesheet" href="Assign3.css">
  <link rel="stylesheet" href="typography.css">
  <link rel="stylesheet" href="colours.css">
  <link rel="stylesheet" href="components.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"> 
  <script defer src="javascript.js"></script>
  

</head>

    <body>
        <nav>
            <div class="logo">TORRES JEWEL <span style="font-weight: normal;">Co.</span></div>
            <button class="hamburger" id="hamburger">&#9776;</button>
            <div class="nav-links" id="navLinks">
              <a href="index.html">Home</a>
              <a href="#">Shop All</a>
              <a href="rings.html">Rings</a>
              <a href="#">Pendants</a>
            </div>
            <div class="cart-icon-container" id="cartIcon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M7 4h-2l-3 7v11a1 1 0 001 1h16a1 1 0 001-1v-11l-3-7h-2m-2 0h-4v2h4v-2m6 7h-16l2.1-5h11.8l2.1 5z"/>
                </svg>
                <span id="cartCount" class="cart-count">0</span>
    
              </div>
              <!-- Cart Preview -->
<div class="cart-preview hidden" id="cartPreview">
    <h3>Your Bag</h3>
    <div id="cartItemsContainer"></div>
    <button id="checkoutBtn">Checkout</button>
  </div>
            
          </nav>
        <div class="product-container">
          <div class="product-image" id="productImage"></div>
          <div class="product-name" id="productName"></div>
          <div class="product-price" id="productPrice"></div>
          <div class="product-description" id="productDescription"></div>
          <button id="addToCartBtn">Add to bag</button>
          <a href="rings.html" class="back-link">← Back to Rings</a>
           
        </div>

        <div class="suggested-products">
            <h2>You may like</h2>
            <div class="suggested-grid" id="suggestedGrid">
              <!-- Suggested items will be inserted here -->
            </div>
          </div>
      
        
      </body>
      <script>
       const product = JSON.parse(localStorage.getItem('selectedProduct'));

if (product) {
  document.getElementById('productImage').style.backgroundImage = `url('${product.image}')`;
  document.getElementById('productImage').style.backgroundSize = 'cover';
  document.getElementById('productImage').style.backgroundPosition = 'center';
  document.getElementById('productName').textContent = product.name;
  document.getElementById('productPrice').textContent = product.price;
  document.getElementById('productDescription').textContent = product.description;
} else {
  document.querySelector('.product-container').innerHTML = '<p>Product not found. Please go back.</p>';
}

// Load existing cart or start empty
let cart = JSON.parse(localStorage.getItem('cart')) || [];

// Update cart count display
function updateCartCount() {
  const count = cart.length;
  document.getElementById('cartCount').textContent = count;
}

// Save cart to localStorage
function saveCart() {
  localStorage.setItem('cart', JSON.stringify(cart));
  updateCartCount();
}

// Add to cart button
document.getElementById('addToCartBtn').addEventListener('click', () => {
  if (!product) {
    alert('No product to add!');
    return;
  }

  cart.push(product);
  saveCart();

  alert(`${product.name} added to your bag`);
});

// Show/hide cart preview with items
document.getElementById('cartIcon').addEventListener('click', () => {
  const preview = document.getElementById('cartPreview');
  preview.classList.toggle('hidden');

  if (preview.classList.contains('hidden')) return; 

  if (cart.length === 0) {
    preview.innerHTML = `
      <div class="cart-header">
        <button class="close-preview" aria-label="Close cart preview">&#8592;</button>
      </div>
      <p>Your bag is empty.</p>
    `;
    attachCloseListener();
    return;
  }

  preview.innerHTML = `
    <div class="cart-header">
      <button class="close-preview" aria-label="Close cart preview">&#8592;</button>
    </div>
    ${cart.map((item, index) => `
      <div class="cart-item" data-index="${index}">
        <div class="cart-image" style="background-image: url('${item.image}')"></div>
        <div class="cart-info">
          <h4>${item.name}</h4>
          <p>${item.price}</p>
          <p>${item.description}</p>
        </div>
        <button class="delete-item" aria-label="Remove item">×</button>
      </div>
    `).join('')}
    <button id="checkoutBtn">Go to Checkout</button>
  `;

  attachCloseListener();
  attachDeleteListeners();
});

// Close button in cart preview
function attachCloseListener() {
  const closeBtn = document.querySelector('.close-preview');
  if (closeBtn) {
    closeBtn.addEventListener('click', () => {
      document.getElementById('cartPreview').classList.add('hidden');
    });
  }
}

// Delete item 
function attachDeleteListeners() {
  document.querySelectorAll('.delete-item').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const index = parseInt(e.target.closest('.cart-item').dataset.index);
      if (!isNaN(index)) {
        cart.splice(index, 1);
        saveCart();
        //  after deletion
        document.getElementById('cartIcon').click();
        document.getElementById('cartIcon').click();
      }
    });
  });
}


updateCartCount();



</script>
    
      
  

</html>
